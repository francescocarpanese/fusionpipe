Welcome to `fusionpipe`!

`fusionpipe` is a pipeline orchestrator designed to streamline data analysis and manage distributed workflows efficiently.

A `pipeline` is defined as a directed acyclic graph (DAG) that connects multiple `nodes`. Each node is uniquely identified by a `node_id` and contains a `code` folder for source files and a `data` folder for output results. The main entry point for each node is the `main.py` script, which is executed by the pipeline when the node runs.

You are currently inside a node directory.

## User Workflow

Before you begin, ensure you are connected to the server and have access to the frontend.

1. **Create a new node** using the frontend interface.
2. **Copy the node folder path** from the frontend (right-click on the node).
3. **Open the node folder** in your preferred editor (e.g., VSCode, Matlab). See the sections below for editor-specific tips.
4. **Develop your code** as usual. Refer to the User API section for guidance on accessing data from parent nodes.

Once you have developed your node's code, you can test it as it would run in the pipeline:

```bash
uv run python main.py
```

Execution logs will be saved to `<node_id>/logs.txt`.

## Useful API for user
Within the folder `<node_id>/code/user_utils` there are some useful matlab and python routines to interact with the pipeline.

When you are developing a node, you need to know the location of the folder of the parents of your node, in order to be able to get the outputs data generated by the parants nodes. To do that you can use the function `get_all_parent_node_folder_paths(node_id)`. 

Have a look to `example_matlab.m`, `example_python.py`, `example_notebook.ipynb` for leveraging these routines.

## uv python package manager
`uv` is a fast Python package manager and build frontend. It is used to install and manage dependencies for your node in a reproducible way. Dependencies are cached, so that they are re-used an not download multiple times.

Every node is initialise as a new python package with `uv init`.

Every node has its dedicated virtual environment that you can activate with source `.venv/bin/activate`

To add some depencies to a node:
- Edit the file `project.toml`.
- Update the `.venv` running the commadn `uv sync`.

In order to run any script then, use
`uv run python <myscript.py>`

## jupyter notebook 
To use a jupyter notebook, you need to have a running python kernel with the required depencies. 

- Every time you start a new node, run the following command
```bash
uv run python init_node_kernel.py
```

This will set-up a python kernel with the same name as the `node_id`, with a minimal set of dependencies. If you need more dependencies, at

- In vscode, select the kernel with same name as the `node_id`. 
- This kernel will be the same one used by the pipeline to run your node. Therefore, if your notebook runs with this kernel while you are developing, it will run in the pipeline too.

To test running a notebook as a script:
- Open `main.py`
- Ucomment the line related to `notebook`
- Test runnig the notebook as a script with `uv run python main.py`.

It is possibile to save a copy of the notebook including, including the output of the cells, in a separate file. See the example in `main.py`.

## matlab
are 

# TODO how to work with python package

# How to import existing python project in the node
